#!/usr/bin/env bash

set -euo pipefail

case $1 in
  "up")
    {{- if eq .chezmoi.hostname "mighty" }}
    dms ipc call audio increment 5
    {{- else }}
    wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+
    {{- end }}
    ;;
  "down")
    {{- if eq .chezmoi.hostname "mighty" }}
    dms ipc call audio decrement 5
    {{- else }}
    wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
    {{- end }}
    ;;
  "toggle")
    {{- if eq .chezmoi.hostname "mighty" }}
    dms ipc call audio mute
    {{- else }}
    wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
    {{- end }}
    ;;
  "toggle-mic")
    {{- if eq .chezmoi.hostname "mighty" }}
    dms ipc call audio micmute
    {{- else }}
    wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
    {{- end }}
    ;;
  *)
    echo "Usage: $0 {up|down|toggle|toggle-mic}"
    exit 1
    ;;
esac
