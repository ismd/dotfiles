#+title: Notes Configuration
#+author: Vladimir Kosteley
#+description: Org mode and note-taking configuration
#+startup: showeverything

* Table of Contents :toc:
- [[#denote][Denote]]
- [[#markdown][Markdown]]
- [[#org-mode][Org Mode]]
  - [[#org-agenda][Org Agenda]]
  - [[#export-to-markdown][Export to Markdown]]
  - [[#modern-org-style][Modern Org Style]]
  - [[#org-appear][Org Appear]]
  - [[#org-modern-indent][Org Modern Indent]]
  - [[#table-of-contents][Table of Contents]]

* Denote
https://github.com/protesilaos/denote

#+begin_src emacs-lisp
(use-package denote
  :ensure t
  :hook (dired-mode . denote-dired-mode)
  :config
  (setq denote-date-prompt-use-org-read-date t)
  (setq denote-directory (expand-file-name "~/Nextcloud/Notes/"))
  (setq denote-infer-keywords t)
  (setq denote-known-keywords '("it" "people" "private"))
  (denote-rename-buffer-mode 1))
#+end_src

* Markdown
https://github.com/jrblevin/markdown-mode

#+begin_src emacs-lisp
(use-package markdown-mode
  :ensure t
  :custom
  (markdown-fontify-code-blocks-natively t)
  (markdown-header-scaling t)
  (markdown-hide-markup t)
  (markdown-italic-underscore t)
  (markdown-list-indent-width 2))
#+end_src

*** Grip
https://github.com/seagle0128/grip-mode

#+begin_src emacs-lisp
(use-package grip-mode
  :ensure t
  :bind (:map markdown-mode-command-map
              ("g" . grip-mode)))
#+end_src

* Org Mode
#+begin_src emacs-lisp
(add-hook 'org-mode-hook #'org-indent-mode)

(require 'org-tempo)

(setq org-auto-align-tags nil
      org-complete-tags-always-offer-all-agenda-tags t
      org-directory (expand-file-name "~/Nextcloud/Notes/")
      org-edit-src-content-indentation 0
      org-ellipsis "…"
      org-fold-catch-invisible-edits 'smart
      org-fontify-quote-and-verse-blocks t
      org-hide-emphasis-markers t
      org-insert-heading-respect-content t
      org-link-descriptive t
      org-pretty-entities t
      org-special-ctrl-a/e t
      org-src-fontify-natively t
      org-src-tab-acts-natively t
      org-tags-column 0
      org-todo-keywords '((sequence "IN-PROGRESS(i)" "TODO(t)" "WAIT(w)" "HOLD(h)" "|" "DONE(d)" "CANCELLED(c)"))
      org-use-sub-superscripts '{})

(setf (alist-get 'file org-link-frame-setup) #'find-file)
#+end_src

** Org Agenda
#+begin_src emacs-lisp
(setq
 ;; Files and directories
 org-agenda-files (list (expand-file-name "~/Nextcloud/Notes/"))

 ;; View settings
 org-agenda-start-on-weekday nil  ;; Start from today, not Monday
 org-agenda-span 'week            ;; Show 7 days ahead
 org-agenda-start-day nil
 org-agenda-show-all-dates nil    ;; Hide days without tasks

 ;; Time settings
 org-extend-today-until 3         ;; Day ends at 3:00 AM
 org-deadline-warning-days 3      ;; Warn 3 days before deadline

 ;; Skip completed tasks
 org-agenda-skip-scheduled-if-done t
 org-agenda-skip-deadline-if-done t
 org-agenda-skip-timestamp-if-done t

 ;; Hide scheduled/deadline tasks in TODO list
 org-agenda-todo-ignore-scheduled t
 org-agenda-todo-ignore-deadlines t

 ;; Display format
 org-agenda-compact-blocks t
 org-agenda-block-separator ?─
 org-agenda-tags-column 0
 org-agenda-prefix-format
 '((agenda . " %i %-12:c%?-12t% s")
   (todo . " %i %-12:c")
   (tags . " %i %-12:c")
   (search . " %i %-12:c"))

 ;; Window settings
 org-agenda-window-setup 'current-window
 org-agenda-restore-windows-after-quit t

 ;; Sorting strategy
 org-agenda-sorting-strategy
 '((agenda habit-down time-up priority-down category-keep)
   (todo priority-down category-keep)
   (tags priority-down category-keep)
   (search category-keep))

 ;; Time grid
 org-agenda-time-grid
 '((daily today require-timed)
   (800 1000 1200 1400 1600 1800 2000)
   "......" "────────────────")

 org-agenda-current-time-string "← now ───────────────────────────────────────────────")

(setq org-agenda-custom-commands
      '(("d" "Dashboard"
         ((agenda "" ((org-agenda-span 1)
                      (org-agenda-overriding-header "Today")))
          (todo "IN-PROGRESS"
                ((org-agenda-overriding-header "In Progress")))
          (todo "TODO"
                ((org-agenda-overriding-header "To Do")
                 (org-agenda-skip-function '(org-agenda-skip-entry-if 'scheduled))))
          (todo "WAIT"
                ((org-agenda-overriding-header "Waiting")))))

        ("w" "Week Ahead"
         ((agenda "" ((org-agenda-span 7)
                      (org-agenda-overriding-header "Week Ahead")))))

        ("n" "Next Tasks"
         ((todo "TODO"
                ((org-agenda-overriding-header "Unscheduled Tasks")
                 (org-agenda-skip-function '(org-agenda-skip-entry-if 'scheduled 'deadline))))))))
#+end_src

** Export to Markdown
https://github.com/larstvei/ox-gfm

#+begin_src emacs-lisp
(use-package ox-gfm
  :ensure t
  :after org)
#+end_src

** Modern Org Style
https://github.com/minad/org-modern

#+begin_src emacs-lisp
(use-package org-modern
  :ensure t
  :custom
  (org-modern-hide-stars nil)
  (org-modern-list '((?- . "•") (?+ . "‣") (?* . "◦")))
  (org-modern-star '("◉" "○" "◈" "◇" "✦"))
  (org-modern-table nil)
  :config
  (global-org-modern-mode))
#+end_src

** Org Appear
https://github.com/awth13/org-appear

Make invisible parts of Org elements appear visible.

#+begin_src emacs-lisp
(use-package org-appear
  :ensure t
  :hook (org-mode . org-appear-mode)
  :custom
  (org-appear-autoemphasis t)
  (org-appear-autoentities t)
  (org-appear-autosubmarkers t)
  (org-appear-autolinks t)
  (org-appear-autokeywords t)
  (org-appear-trigger 'on-change))
#+end_src

** Org Modern Indent
https://github.com/jdtsmith/org-modern-indent

#+begin_src emacs-lisp
(use-package org-modern-indent
  :ensure (:host github :repo "jdtsmith/org-modern-indent")
  :config
  (add-hook 'org-mode-hook #'org-modern-indent-mode 90))
#+end_src

** Table of Contents
#+begin_src emacs-lisp
(use-package toc-org
  :ensure t
  :commands toc-org-enable
  :hook (org-mode . toc-org-enable))
#+end_src
